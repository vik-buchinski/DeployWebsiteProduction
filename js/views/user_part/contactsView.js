define(["server"],function(a){return{init:function(){window.app.views.Contacts||(window.app.views.Contacts=Backbone.View.extend({initialize:function(a){this.data=a.data},render:function(){return this.setElement(this.template({data:this.data})),this},events:{"click #send-message":"submit"},validate:function(a,b,c){var d=new Array;""==a.val()&&d.push($.i18n.t("user.contacts.no_name"));var e=new RegExp("^[a-zA-Z0-9._-]+@[a-zA-Z0-9_-]+[.][a-zA-Z0-9._-]+$");return""==b.val()?d.push($.i18n.t("user.contacts.no_email")):e.test(b.val())||d.push($.i18n.t("user.contacts.wrong_email")),""==c.val()&&d.push($.i18n.t("user.contacts.no_message")),d.length?(d=d.join(", "),d=d.toLowerCase(),d=d.charAt(0).toUpperCase()+d.slice(1)+"."):d=null,d},submit:function(b){var c=this;if(b.preventDefault(),this.$el.hasClass("loading"))return!1;var d=$("#input-name"),e=$("#input-email"),f=$("#input-message"),g=$("#input-phone"),h=this.validate(d,e,f);return h?(c.$el.find(".message").html('<span class="failure">'+h+"</span>").show(),!1):(this.$el.addClass("loading"),this.$el.find(".message").hide(),void a.sendMessage(d.val(),g.val(),e.val(),f.val(),function(){c.$el.find(".message").html('<span class="success">'+$.i18n.t("user.contacts.mesage_sent")+"</span>").show(),c.reset()},function(){c.$el.removeClass("loading")}))},reset:function(){$("#input-name").val(""),$("#input-phone").val(""),$("#input-email").val(""),$("#input-message").val(""),this.$el.removeClass("loading")}}))}}});