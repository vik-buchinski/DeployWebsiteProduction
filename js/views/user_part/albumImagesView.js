define([],function(){return{init:function(){window.app.views.AlbumImages||(window.app.views.AlbumImages=Backbone.View.extend({initialize:function(a){this.data=a.data,window.Vent.trigger("setFullscreenImages",{images:a.data.images})},render:function(){var a=this;return $(window).on("resize",function(){$("section.page div.container > div").hasClass("images-grid")&&a.buildView()}),setTimeout(function(){a.buildView()},100),$(".container").addClass("fullscreen-content"),this},buildView:function(){this.setElement(this.template({data:this.buildImagesGrid(),description:this.data.album_description})),$("section.page .container").html(this.$el),$(this.$el).find("img.lazy").lazyload({threshold:200})},events:{"click img.lazy":"openFSImage"},openFSImage:function(a){window.Vent.trigger("openFSImage",{image_id:$(a.currentTarget).data("id")})},buildImagesGrid:function(){var a,b=$(window).width(),c=15,d=$("section.page .container").css("padding-right").replace("px",""),e=$("section.page .container").css("padding-left").replace("px","");return a=480>b?1:800>b?2:1e3>b?3:4,this.buildColumns(a,b,c,d,e)},buildColumns:function(a,b,c,d,e){var f={};f.totalHeight=0,f.images=new Array;var g=(b-d-e-(c*a-c))/a,h=1,i=this.createArray(a,0);return _.each(this.data.images,function(b){var d=b.image_height/(b.image_width/g),e={description:b.description,id:b.id,url:b.image_url,styles:{width:g,height:d}};e.styles.top=i[h-1],h-1==0?e.styles.left=0:e.styles.left=(h-1)*g+(c*h-c),i[h-1]+=d+c,h==a?h=1:h++,f.images.push(e),f.totalHeight=Math.max.apply(Math,i)}),f},createArray:function(a,b){var c=new Array(a);if(2==arguments.length)for(var d=0;a>d;++d)c[d]=b;return c}}))}}});