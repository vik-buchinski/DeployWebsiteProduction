define(["server","local-storage","constants","common","ckeditor","ckjquery"],function(a,b,c,d){return{init:function(){window.app.views.AdminAbout||(window.app.views.AdminAbout=Backbone.View.extend({initialize:function(a){this.about_data=a.about_data},render:function(){return document.title=$.i18n.t("admin.about-page.page-title"),this.$el.html(this.MainContainerTemplate({all_pages:c.LEFT_PANELS,album_types:c.ALBUM_TYPES,selected_page:c.LEFT_PANELS.about})),$(this.$el).find(".main").html(this.template({save_url:c.BASE_API_URL+c.API_METHODS.admin.about.url,data:this.about_data})),$(this.$el).find("textarea#description").ckeditor({language:c.APP_LANGUAGE}),this},events:{"click #submit-btn":"aboutFormSubmit","change #content_image_input":"aboutFileChanged","click #save_title_image_btn":"titleImageSubmit","change #title_image_input":"titleImageChanged","click #delete_title_image_btn":"deleteTitleEvent"},deleteTitleEvent:function(){return this.about_data.title_image_url?a.deleteAdminAboutTitleImage(b.getSession().session.token,function(a){alert($.i18n.t("deleted-message")),window.location.reload()}):alert($.i18n.t("no-image-message")),!1},titleImageChanged:function(){var a=$("#title_image_input")[0].files[0];if(d.isImage(a)){var b=$("#title_image_input")[0].files[0].size;if(b>c.MAX_UPLOADS_FILE_SIZE)$("#title_image_input").val(""),alert($.i18n.t("max-file-size-message")+c.MAX_UPLOADS_FILE_SIZE/1024/1024+$.i18n.t("mb-prefix"));else{var e=new FileReader;e.onload=function(a){$("#title_image").attr("src",a.target.result)},e.readAsDataURL($("#title_image_input")[0].files[0])}}else $("#title_image_input").val(""),alert($.i18n.t("supported-format-message")+c.SUPPORTED_IMAGES_FORMAT)},titleImageSubmit:function(){var e=$("#title_image_input")[0].files[0];if(e){if(!d.isImage(e))return alert($.i18n.t("supported-format-message")+c.SUPPORTED_IMAGES_FORMAT),!1;var f=$("#title_image_input")[0].files[0].size;if(f>c.MAX_UPLOADS_FILE_SIZE)return $("#title_image_input").val(""),alert($.i18n.t("max-file-size-message")+c.MAX_UPLOADS_FILE_SIZE/1024/1024+$.i18n.t("mb-prefix")),!1;var g=new FormData;g.append("image",$("#title_image_input")[0].files[0]),g.append("Session-Token",b.getSession().session.token),a.submitAdminAboutTitleImage(g,function(a){alert($.i18n.t("saved-message")),window.location.reload()})}else alert($.i18n.t("select-image-message"));return!1},aboutFormSubmit:function(){var c=new FormData;return c.append("content_image",$("#content_image_input")[0].files[0]),c.append("description",$("#description").val()),c.append("Session-Token",b.getSession().session.token),a.submitAdminAbout(c,function(a){alert($.i18n.t("saved-message"))}),!1},aboutFileChanged:function(){var a=$("#content_image_input")[0].files[0];if(d.isImage(a)){var b=$("#content_image_input")[0].files[0].size;if(b>c.MAX_UPLOADS_FILE_SIZE)$("#content_image_input").val(""),alert($.i18n.t("max-file-size-message")+c.MAX_UPLOADS_FILE_SIZE/1024/1024+$.i18n.t("mb-prefix"));else{var e=new FileReader;e.onload=function(a){$("#content_image").attr("src",a.target.result)},e.readAsDataURL($("#content_image_input")[0].files[0])}}else $("#content_image_input").val(""),alert($.i18n.t("supported-format-message")+c.SUPPORTED_IMAGES_FORMAT)}}))}}});